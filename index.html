<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>××©×—×§ ×”×—×¤×¨×¤×¨×ª</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; text-align: center; background: #f4f7f6; padding: 20px; direction: rtl; }
        .card { background: white; padding: 25px; border-radius: 20px; box-shadow: 0 8px 16px rgba(0,0,0,0.1); max-width: 450px; margin: auto; }
        button { background-color: #3498db; color: white; border: none; padding: 12px 24px; border-radius: 10px; cursor: pointer; font-size: 18px; margin: 10px 5px; font-weight: bold; width: 85%; }
        input { padding: 12px; width: 85%; margin-bottom: 15px; border-radius: 8px; border: 1px solid #ddd; font-size: 16px; text-align: center; }
        .hidden { display: none !important; }
        .highlight { background: #fff9c4; padding: 15px; border-radius: 10px; border: 2px solid #fbc02d; margin: 15px 0; font-weight: bold; }
    </style>
</head>
<body>
    <div class="card" id="s-start">
        <h2>ğŸ•µï¸ ××©×—×§ ×”×—×¤×¨×¤×¨×ª</h2>
        <input type="text" id="names" placeholder="×©××•×ª ×¢× ×¤×¡×™×§×™× (× ×•×¢×”, ×“×Ÿ, ×©×™)">
        <button onclick="startGame()">×”×ª×—×œ ××©×—×§!</button>
    </div>
    <div class="card hidden" id="s-reveal">
        <h3 id="pName"></h3>
        <button id="showBtn" onclick="revealSecret()">×—×©×•×£ ××™×œ×” ğŸ¤«</button>
        <div id="secretBox" class="hidden">
            <p id="info" style="font-size:22px; font-weight:bold; color:#27ae60;"></p>
            <button onclick="nextPlayer()">×”×‘× ×ª×™, ×”×¢×‘×¨ ×”×œ××”</button>
        </div>
    </div>
    <div class="card hidden" id="s-game">
        <h3>ğŸ® ×©×œ×‘ ×”×©××œ×•×ª</h3>
        <div class="highlight" id="qTurn"></div>
        <div class="highlight" style="background:#e1f5fe; border-color:#81d4fa;"> ×”×©××œ×”: <span id="qText"></span></div>
        <button onclick="nextQuestion()">×”×©××œ×” ×”×‘××” â¡ï¸</button>
    </div>
    <div class="card hidden" id="s-vote">
        <h3 id="voterTitle"></h3>
        <div id="voteButtons"></div>
    </div>
    <div class="card hidden" id="s-results">
        <h1 id="winMsg"></h1>
        <p id="spyReveal"></p>
        <button onclick="location.reload()">××©×—×§ ×—×“×© ğŸ”„</button>
    </div>

<script>
    let players=[], spy="", word="", pIdx=0, qIdx=0, votes={};
    const words=["×¤×™×¦×”", "×”××‘×•×¨×’×¨", "×¡×•×©×™", "×’×œ×™×“×”", "×¤×œ××¤×œ", "×¤×¡×˜×”", "×©×•×§×•×œ×“"];
    const questions=["×”×× ×–×” ×—×?", "×”×× ××•×›×œ×™× ××ª ×–×” ×‘×™×“×™×™×?", "×”×× ×–×” ××ª×•×§?", "×”×× ×™×© ×‘×–×” ×‘×¦×§?", "×”×× ×–×” ×™×§×¨?", "×”×× ×™×œ×“×™× ××•×”×‘×™× ××ª ×–×”?"];

    function startGame() {
        let v = document.getElementById('names').value;
        players = v.split(',').map(s=>s.trim()).filter(s=>s!=="");
        if(players.length < 3) return alert("×¦×¨×™×š 3 ×©×—×§× ×™×!");
        spy = players[Math.floor(Math.random()*players.length)];
        word = words[Math.floor(Math.random()*words.length)];
        players.forEach(p=>votes[p]=0);
        document.getElementById('s-start').classList.add('hidden');
        document.getElementById('s-reveal').classList.remove('hidden');
        updateP();
    }
    function updateP() {
        document.getElementById('pName').innerText = "×ª×•×¨: " + players[pIdx];
        document.getElementById('secretBox').classList.add('hidden');
        document.getElementById('showBtn').classList.remove('hidden');
    }
    function revealSecret() {
        document.getElementById('info').innerText = (players[pIdx]===spy) ? "××ª×” ×”×—×¤×¨×¤×¨×ª! ğŸ•µï¸" : "×”××™×œ×”: " + word;
        document.getElementById('secretBox').classList.remove('hidden');
        document.getElementById('showBtn').classList.add('hidden');
    }
    function nextPlayer() {
        pIdx++;
        if(pIdx < players.length) updateP();
        else { document.getElementById('s-reveal').classList.add('hidden'); document.getElementById('s-game').classList.remove('hidden'); nextQuestion(); }
    }
    function nextQuestion() {
        if(qIdx < questions.length) {
            let a=Math.floor(Math.random()*players.length), b=Math.floor(Math.random()*players.length);
            while(a===b) b=Math.floor(Math.random()*players.length);
            document.getElementById('qTurn').innerText = players[a] + " ×©×•××œ/×ª ××ª " + players[b];
            document.getElementById('qText').innerText = questions[qIdx++];
        } else { startVote(); }
    }
    function startVote() {
        pIdx=0; document.getElementById('s-game').classList.add('hidden'); document.getElementById('s-vote').classList.remove('hidden'); updateVote();
    }
    function updateVote() {
        document.getElementById('voterTitle').innerText = "×”×¦×‘×¢×”: " + players[pIdx];
        let h = ""; players.forEach(p => { if(p!==players[pIdx]) h += <button onclick="doVote('${p}')">${p}</button>; });
        document.getElementById('voteButtons').innerHTML = h;
    }
    function doVote(p) {
        votes[p]++; pIdx++;
        if(pIdx < players.length) updateVote();
        else {
            document.getElementById('s-vote').classList.add('hidden'); document.getElementById('s-results').classList.remove('hidden');
            let win = Object.keys(votes).reduce((a,b)=>votes[a]>votes[b]?a:b);
            document.getElementById('winMsg').innerText = (win===spy) ? "×ª×¤×¡×ª× ××•×ª×”! ğŸ‰" : "×”×—×¤×¨×¤×¨×ª × ×™×¦×—×”! ğŸ˜ˆ";
            document.getElementById('spyReveal').innerText = "×”×—×¤×¨×¤×¨×ª ×”×™×™×ª×”: " + spy;
        }
    }
</script>
</body>
</html>
